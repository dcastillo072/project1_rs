---
title: "Project_1_Reproducible Researh"
author: "Dodanim"
date: '2022-06-19'
output: html_document
---

## First step: load data
Loading and preprocessing the data
Show any code that is needed to

* Load the data

* Process/transform the data (if necessary) into a format suitable for your analysis

```{r reading, cache=TRUE, echo=TRUE}
datos <- read.csv("activity.csv")
head(datos)
str(datos)
summary(datos)
```

### Procesing data and cleaning

```{r date_conversion, message=FALSE, echo=TRUE}
datos$day <- weekdays(as.Date(datos$date))
datos$date <- as.POSIXct(datos$date, format = "%Y-%m-%d")

datos_limpios <- datos[!is.na(datos$steps),]
head(datos_limpios)
```

## What is the average daily activity pattern?
#### 1. Calculate the total number of steps taken per day (ignore the missing values)
```{r daily_total,message=FALSE, echo=TRUE}
sumTable <- aggregate(datos$steps ~ datos$date, FUN=sum, )
colnames(sumTable)<- c("Date", "Steps")

#making histogram
hist(sumTable$Steps, breaks=5, xlab="Steps", main = "Total Steps per Day")
```

Calculate and report the mean and median of the total number of steps taken per day
```{r summary, echo=TRUE}
as.integer(mean(sumTable$Steps))
as.integer(median(sumTable$Steps))
```

## What is the average daily activity pattern?
We need two:
1- Make a time series plot
2- Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r daily, fig.width=12, echo=TRUE}
#import libraries
library(plyr)
library(ggplot2)

#creating data
datos_limpios <- datos[!is.na(datos$steps),]

#creating average
Table_inter <- ddply(datos_limpios, .(interval), summarize, Avg=mean(steps))

#creating line plot
p <- ggplot(Table_inter, aes(x=interval, y=Avg), xlab="Interval", ylab = "Average Numbwer of Steps")
p + geom_line() + xlab("Interval") + ylab("Average Number of Steps") + ggtitle("Average number of Steps per Interval")


##Maximum steps by interval
maxSteps <- max(Table_inter$Avg)
##Which interval contains the maximum average number of steps
Table_inter[Table_inter$Avg==maxSteps,1]

```
